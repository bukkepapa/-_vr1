# 在庫引当チェックツール

PandasとStreamlitを使用した在庫引当チェックアプリケーションです。倉庫在庫ファイルと受注ファイルを読み込み、在庫の過不足を確認できます。

## 機能

- 速報倉庫在庫ファイル（Excel/CSV）の読み込み
- 受注ファイル（テキスト）の読み込み（Shift-JIS対応）
- 商品ごとの在庫引当計算
- 不足商品の検出と詳細表示

## 必要要件

- Python 3.10以上
- 必要なライブラリは `requirements.txt` に記載

## インストール

```powershell
# 依存ライブラリのインストール
pip install -r requirements.txt
```

## 使用方法

### アプリケーションの起動

```powershell
streamlit run app.py
```

ブラウザが自動的に開き、アプリケーションが表示されます。

### ファイル形式の要件

#### ① 速報倉庫在庫ファイル (.xlsx, .csv)

- **ヘッダー位置**: 4行目（Pandasの `header=3`）
- **必要な列**:
  - C列（インデックス2）: 商品コード
  - E列（インデックス4）: 倉庫在庫数

#### ② 受注ファイル (.txt)

- **文字コード**: Shift-JIS
- **区切り文字**: タブ（`\t`）
- **ヘッダー**: 1行目
- **必要な列インデックス**（0から始まる）:
  - 14: 顧客コード（O列）
  - 15: 顧客名（P列）
  - 97: 商品コード（CT列）
  - 118: 発注数量（DO列）

### 操作手順

1. **ファイルのアップロード**
   - 左側: 速報倉庫在庫ファイルをアップロード
   - 右側: 受注ファイルをアップロード

2. **チェック実行**
   - 「在庫引当チェック実行」ボタンをクリック

3. **結果の確認**
   - **全商品在庫アリ**: すべての商品で在庫が十分
   - **不足商品アリ**: 在庫不足の商品がある場合、以下の情報が表示されます
     - 商品コード
     - 倉庫在庫数
     - 受注合計数
     - 不足数（絶対値）
     - 顧客コード（複数の場合はカンマ区切り）
     - 顧客名（複数の場合はカンマ区切り）

## エラーハンドリング

- **文字コードエラー**: Shift-JISでの読み込みに失敗した場合、エラーメッセージが表示されます
- **ファイル未選択**: 両方のファイルがアップロードされていない場合、警告が表示されます
- **データ変換エラー**: 数値に変換できないデータは0として扱われます

## 技術スタック

- **Python**: 3.10以上
- **Streamlit**: Webアプリケーションフレームワーク
- **Pandas**: データ処理ライブラリ
- **openpyxl**: Excelファイル読み込み用

## プロジェクト構成

```
在庫引当チェックツール/
├── app.py              # メインアプリケーション
├── requirements.txt    # 依存ライブラリ
└── README.md          # このファイル
```

## 注意事項

- 受注ファイルは必ずShift-JISエンコーディングで保存してください
- 列インデックスは実際のファイル形式に合わせて調整が必要な場合があります
- 大量のデータを処理する場合、処理に時間がかかることがあります
